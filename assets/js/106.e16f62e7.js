(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{425:function(t,a,s){"use strict";s.r(a);var n=s(4),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"env"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#env"}},[t._v("#")]),t._v(" env")]),t._v(" "),a("p",[t._v("要进行 frida 的研究, 你需要准备一台可以 root 的手机. 这里有一些链接可以帮助到你. 这里主要介绍使用 "),a("code",[t._v("magisk")]),t._v(" 获取 root 权限")]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://sspai.com/post/57923",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pixel 4 XL 刷入 Magisk、Root"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://medium.com/@jonathan.mercandalli_41381/how-to-root-a-pixel-device-e893969ca5dd",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://medium.com/@jonathan.mercandalli_41381/how-to-root-a-pixel-device-e893969ca5dd"),a("OutboundLink")],1)])]),t._v(" "),a("ol",[a("li",[t._v("prepare compute\n"),a("ol",[a("li",[t._v("download image from google, "),a("a",{attrs:{href:"https://developers.google.com/android/images?hl=zh-cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developers.google.com/android/images?hl=zh-cn"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("install magisk from "),a("a",{attrs:{href:"https://github.com/topjohnwu/Magisk/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topjohnwu/Magisk/releases"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[t._v("Preparing the phone\n"),a("ol",[a("li",[t._v("enable USB debugging")])])]),t._v(" "),a("li",[t._v("Unlocking the bootloader")]),t._v(" "),a("li",[t._v("flash Magisk")])]),t._v(" "),a("h2",{attrs:{id:"magisk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#magisk"}},[t._v("#")]),t._v(" magisk")]),t._v(" "),a("p",[t._v("这里介绍使用 "),a("code",[t._v("magisk")]),t._v(" 辅助获取, root 权限")]),t._v(" "),a("h3",{attrs:{id:"modules"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modules"}},[t._v("#")]),t._v(" modules")]),t._v(" "),a("ul",[a("li",[t._v("Systemless Hosts")]),t._v(" "),a("li",[t._v("Custom Certificate Authorities")])]),t._v(" "),a("h3",{attrs:{id:"magiskhidepropsconf-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#magiskhidepropsconf-使用"}},[t._v("#")]),t._v(" MagiskHidePropsConf 使用")]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://github.com/Magisk-Modules-Repo/MagiskHidePropsConf/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("MagiskHidePropsConf"),a("OutboundLink")],1),t._v(" 可以修改系统的配置属性, 比如设置全局设置 app debuggable。 但是作者截止 2023 年一月份, 不再维护此项目了")])]),t._v(" "),a("p",[t._v("一、首先从"),a("a",{attrs:{href:"https://forum.xda-developers.com/t/module-deprecated-magiskhide-props-config-safetynet-prop-edits-and-more-v6-1-2.3789228/",target:"_blank",rel:"noopener noreferrer"}},[t._v("网站"),a("OutboundLink")],1),t._v("下载 6.1.2 版本的 MagiskHidePropsConf 模块包二、设置 debuggale 过程如下")]),t._v(" "),a("p",[t._v("这一步主要的步骤是设置 "),a("code",[t._v("ro.debuggable 1")]),t._v(", 这样所有的 app 就都可以调试了。步骤如下:")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("adb shell "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#adb 进入命令行模式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("su")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#切换至超级用户")]),t._v("\nmagisk resetprop ro.debuggable "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nstop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#一定要通过该方式重启")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("至此重启手机后, 你的手机里面的应用应该就可以全局 debug 了.")]),t._v(" "),a("p",[t._v("如下图:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/jacky1234/picArchieve@master/uPic/20230606_203711_lH345Z.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"magiskfrida"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#magiskfrida"}},[t._v("#")]),t._v(" MagiskFrida")]),t._v(" "),a("blockquote",[a("p",[t._v("MagiskFrida lets you run frida-server on boot with Magisk。 如果你想使用最新的 frida-server 版本, 可以尝试更新 MagiskFrida 模块. 点击"),a("a",{attrs:{href:"https://github.com/ViRb3/magisk-frida",target:"_blank",rel:"noopener noreferrer"}},[t._v("magisk-frida"),a("OutboundLink")],1),t._v("查看")])]),t._v(" "),a("h2",{attrs:{id:"frida"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frida"}},[t._v("#")]),t._v(" frida")]),t._v(" "),a("blockquote",[a("p",[t._v("Frida: Dynamic instrumentation toolkit for developers, reverse-engineers, and security researchers.\n个人非常喜欢 frida 平台, 不仅是因为功能的强大, 还提供了实时交互工具 "),a("code",[t._v("objection")])])]),t._v(" "),a("h2",{attrs:{id:"gadget"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gadget"}},[t._v("#")]),t._v(" Gadget")]),t._v(" "),a("p",[t._v("Frida Gadget 是 Frida 框架的一个组件, 它用于在目标应用程序中注入 Frida 运行时, 从而实现对应用程序的动态分析和修改。")]),t._v(" "),a("p",[t._v("Frida 是一个功能强大的动态代码注入和调试工具, 可以用于在运行时修改和监视应用程序的行为。它支持多种操作系统和架构, 并提供了丰富的 API, 使得开发人员能够在应用程序运行时进行代码注入、函数挂钩、数据修改等操作。")]),t._v(" "),a("p",[t._v("Frida Gadget 是 Frida 框架的一部分, 它是一个特殊的库, 被注入到目标应用程序中。注入 Frida Gadget 后, Frida 可以与目标应用程序交互, 监视和修改其运行时行为。Frida Gadget 允许开发人员在应用程序的上下文中执行 JavaScript 代码, 从而实现各种功能, 如函数跟踪、API 调用监视、数据修改等。")]),t._v(" "),a("p",[t._v("使用 Frida Gadget, 开发人员可以进行以下操作:")]),t._v(" "),a("ul",[a("li",[t._v("动态函数跟踪: 可以跟踪目标应用程序中的函数调用, 并获取参数、返回值等信息, 用于分析应用程序的执行流程和内部逻辑。")]),t._v(" "),a("li",[t._v("API 调用监视: 可以监视目标应用程序对特定 API 的调用, 包括系统级 API 和应用程序特定的 API, 用于分析应用程序的行为和检测潜在的安全问题。")]),t._v(" "),a("li",[t._v("数据修改和重定向: 可以在运行时修改目标应用程序的内存数据, 包括修改变量的值、修改函数的实现等, 用于实现应用程序的动态修改和调试。")]),t._v(" "),a("li",[t._v("密码破解和漏洞分析: 可以通过 Frida Gadget 对目标应用程序进行动态分析, 帮助发现潜在的安全漏洞和进行密码破解。")])]),t._v(" "),a("p",[t._v("总之, Frida Gadget 是 Frida 框架中的一个关键组件, 它为开发人员提供了强大的动态分析和修改目标应用程序的能力, 帮助他们进行应用程序的逆向工程、安全分析和调试等任务。")]),t._v(" "),a("h2",{attrs:{id:"stalker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stalker"}},[t._v("#")]),t._v(" stalker")]),t._v(" "),a("p",[t._v("Frida Stalker 是 Frida 框架的一个特性, 它提供了一种高级的动态分析技术, 用于跟踪目标应用程序的执行流程。")]),t._v(" "),a("p",[t._v("Stalker 基于 Frida 框架的动态代码注入能力, 通过在目标应用程序中注入代码, 并在运行时跟踪其指令的执行, 从而实现对应用程序的静态和动态分析。Stalker 的主要目标是捕获和分析目标应用程序的控制流, 包括函数调用、基本块的执行顺序、分支跳转等。")]),t._v(" "),a("p",[t._v("使用 Frida Stalker, 开发人员可以进行以下操作:")]),t._v(" "),a("ul",[a("li",[t._v("函数调用跟踪: Stalker 可以跟踪目标应用程序中的函数调用, 记录函数的入口、返回地址和参数, 以及函数的执行时间和频率。这对于分析应用程序的执行路径、理解函数之间的调用关系和参数传递非常有帮助。")]),t._v(" "),a("li",[t._v("基本块跟踪: Stalker 可以跟踪目标应用程序中的基本块(一组连续的指令), 记录基本块的执行顺序和频率, 以及基本块之间的跳转关系。这有助于分析应用程序的控制流, 包括条件分支、循环和函数调用。")]),t._v(" "),a("li",[t._v("动态分析和调试: Stalker 可以在运行时对目标应用程序进行动态分析和调试, 例如捕获函数调用的参数和返回值、监视特定的 API 调用、跟踪内存访问等。这使得开发人员能够深入了解应用程序的行为, 快速定位问题和漏洞, 并进行动态修改和调试。")]),t._v(" "),a("li",[t._v("逆向工程: Stalker 可以用于逆向工程任务, 如反编译、恢复数据结构和算法等。通过跟踪目标应用程序的执行流程, 开发人员可以还原出应用程序的逻辑和算法, 帮助理解其内部工作原理。")])]),t._v(" "),a("p",[t._v("总之, Frida Stalker 是 Frida 框架中的一个重要功能, 它提供了强大的动态分析能力, 帮助开发人员深入理解和分析目标应用程序的执行流程, 从而实现应用程序的逆向工程、安全分析和调试等任务。")]),t._v(" "),a("h2",{attrs:{id:"tutorials"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tutorials"}},[t._v("#")]),t._v(" Tutorials")]),t._v(" "),a("h3",{attrs:{id:"founctions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#founctions"}},[t._v("#")]),t._v(" Founctions")]),t._v(" "),a("p",[t._v("解释官方示例的 "),a("a",{attrs:{href:"https://frida.re/docs/functions/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Injecting Strings and Calling a Function"),a("OutboundLink")],1),t._v(" 的一段 snippet code")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" frida\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys\n\nsession "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" frida"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hi"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nscript "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create_script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\nconst st = Memory.allocUtf8String("TESTMEPLZ!");\nconst f = new NativeFunction(ptr("%s"), \'int\', [\'pointer\']);\n    // In NativeFunction param 2 is the return value type,\n    // and param 3 is an array of input types\nf(st);\n"""')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on_message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" on_message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("p",[t._v('这段代码使用 Frida 进行动态插桩, 目标应用程序是名为 "hi" 的进程。')]),t._v(" "),a("p",[t._v('首先, 你导入了 frida 和 sys 模块。然后, 使用 frida.attach 方法附加到目标应用程序 "hi", 创建了一个 Frida 会话(session)。')]),t._v(" "),a("p",[t._v("接下来, 你使用 session.create_script 创建了一个脚本对象, 并将 JavaScript 代码作为参数传递给它。这个 JavaScript 代码块使用了 Frida 的 Memory.allocUtf8String 方法来分配一个 UTF-8 字符串的内存, 并将其赋值给变量 st。然后, 使用 NativeFunction 创建了一个函数对象 f, 该函数对象会调用一个地址为 %s 的函数, 返回值类型为整数, 参数类型为指针。")]),t._v(" "),a("p",[a("code",[t._v('ptr("%s")')]),t._v(" 是一个占位符, 将在代码中的字符串中被实际的地址值替换。 "),a("code",[t._v("int(sys.argv[1], 16)")]),t._v(" 用于获取命令行参数并将其解析为十六进制的整数值。")]),t._v(" "),a("p",[t._v("然后, 你定义了一个 "),a("code",[t._v("on_message")]),t._v(" 函数作为消息处理程序, 用于处理来自 Frida 脚本的消息。")]),t._v(" "),a("p",[t._v("接下来, 使用 "),a("code",[t._v("script.on('message', on_message)")]),t._v(" 注册了消息处理程序。当 Frida 脚本收到消息时, "),a("code",[t._v("on_message")]),t._v(" 函数将被调用。")]),t._v(" "),a("p",[t._v("然后, 调用 "),a("code",[t._v("script.load()")]),t._v(" 加载 Frida 脚本, 使其开始在目标应用程序中执行。")]),t._v(" "),a("p",[t._v("最后, 通过 "),a("code",[t._v("print(message)")]),t._v(" 将收到的消息打印出来, 以便你查看和处理。")]),t._v(" "),a("p",[t._v('请确保在运行此代码之前, 已经正确配置 Frida 环境, 并且目标应用程序 "hi" 已经运行并可附加。你还需要根据你的具体需求定义 '),a("code",[t._v("on_message")]),t._v(" 函数, 并根据代码中的占位符 %s 提供实际的地址值。")]),t._v(" "),a("p",[t._v("运行脚本后, 当 Frida 脚本收到消息时, on_message 函数会将消息打印出来, 供你查看和处理。")]),t._v(" "),a("h3",{attrs:{id:"message"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#message"}},[t._v("#")]),t._v(" Message")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("这块内容主要包含了如下内容,  更多详情可见"),a("a",{attrs:{href:"https://frida.re/docs/messages/",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("Sending messages from a target process")]),t._v(" "),a("li",[t._v("Receiving messages in a target process")]),t._v(" "),a("li",[t._v("Blocking receives in the target process: 监听目标进程调用方法参数, 通过 python 客户端修改调用参数示例")])])]),t._v(" "),a("p",[t._v("一、Sending messages from a target process")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" frida\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys\n\nsession "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" frida"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nscript "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create_script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"send(1337);"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on_message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" on_message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("p",[t._v("首先使用 "),a("code",[t._v("frida.attach")]),t._v(' 方法连接到目标应用程序 "hello"。然后, 你创建了一个脚本对象, 并使用 '),a("code",[t._v("session.create_script")]),t._v(" 方法创建了一个脚本, 该脚本调用了 send(1337) 函数。")]),t._v(" "),a("p",[t._v("接下来, 你定义了一个 on_message 函数, 用于处理从脚本收到的消息, 并打印出来。然后, 你将 on_message 函数注册到脚本的 'message' 事件上, 以便在脚本接收到消息时被调用。")]),t._v(" "),a("p",[t._v("最后, 你使用 "),a("code",[t._v("script.load()")]),t._v(" 方法加载脚本, 并使用 "),a("code",[t._v("sys.stdin.read()")]),t._v(" 使程序等待用户输入。这样做是为了保持脚本的运行, 直到手动终止程序。")]),t._v(" "),a("h3",{attrs:{id:"ios"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ios"}},[t._v("#")]),t._v(" IOS")]),t._v(" "),a("h3",{attrs:{id:"android"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#android"}},[t._v("#")]),t._v(" Android")]),t._v(" "),a("blockquote",[a("p",[t._v("内容 "),a("a",{attrs:{href:"https://frida.re/docs/android/",target:"_blank",rel:"noopener noreferrer"}},[t._v("链接"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[t._v("frida-server")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("frida-server --help")]),t._v(" 帮助")]),t._v(" "),a("li",[a("code",[t._v("frida-server --version")]),t._v(" check the version of the Frida server on the device or emulator.")]),t._v(" "),a("li",[a("code",[t._v("lsof | grep frida | grep LISTEN")]),t._v(" 查看 frida 当前监听的端口, 下面的数据说明当前监听的端口为 27042 "),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/jacky1234/picArchieve@master/uPic/20230617_155921_3MIbuy.png",alt:"frida-server-port"}})])]),t._v(" "),a("p",[t._v("二、升级 "),a("code",[t._v("frida-server")])]),t._v(" "),a("ol",[a("li",[t._v("首先升级 magisk-frida 到指定版本")]),t._v(" "),a("li",[t._v("下载指定的 "),a("code",[t._v("frida-server")]),t._v(" 并 push 到 "),a("code",[t._v("/data/local/tmp/")]),t._v(" 目录")]),t._v(" "),a("li",[t._v("重启。通过 magisk 加载最新的 "),a("code",[t._v("frida-server")])])]),t._v(" "),a("h2",{attrs:{id:"tools"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tools"}},[t._v("#")]),t._v(" Tools")]),t._v(" "),a("h3",{attrs:{id:"frida-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frida-cli"}},[t._v("#")]),t._v(" frida cli")]),t._v(" "),a("blockquote",[a("p",[t._v("usage: frida [options] target")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("frida -h")])]),t._v(" "),a("li",[a("code",[t._v("frida -U -l <script.js> -f <process_name>")]),t._v(" 将 Frida 附加到目标进程")]),t._v(" "),a("li",[a("code",[t._v("frida -D <device ID> -l <script.js> <process_name>")]),t._v(" 以 attach 模式加载 script, 此种情况下会打印出 js 的错误。 (而直接使用)")]),t._v(" "),a("li",[a("code",[t._v("frida -D <device ID> -l <script.js> -f <process_name>")]),t._v(" 以 spawn 模式加载 script")])]),t._v(" "),a("RText",{attrs:{text:"options:"}}),t._v(" "),a("ul",[a("li",[a("code",[t._v("-f")]),t._v(": spawn file")])]),t._v(" "),a("h3",{attrs:{id:"frida-ps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frida-ps"}},[t._v("#")]),t._v(" frida-ps")]),t._v(" "),a("blockquote",[a("p",[t._v("This is a command-line tool for listing processes, which is very useful when interacting with a remote system.")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("frida-ps -U")]),t._v(" Connect Frida to an iPad over USB and list running processes")]),t._v(" "),a("li",[a("code",[t._v("frida-ps -Ua")]),t._v(" List running applications")]),t._v(" "),a("li",[a("code",[t._v("frida-ps -Uai")]),t._v(" List installed applications")]),t._v(" "),a("li",[a("code",[t._v("frida-ps -D <DEVICE ID>")]),t._v(" Connect Frida to the specific device")])]),t._v(" "),a("h3",{attrs:{id:"frida-trace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frida-trace"}},[t._v("#")]),t._v(" frida-trace")]),t._v(" "),a("blockquote",[a("p",[a("RouterLink",{attrs:{to:"/pages/7639ce/"}},[t._v("jump")])],1)]),t._v(" "),a("h3",{attrs:{id:"frida-ls-devices"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frida-ls-devices"}},[t._v("#")]),t._v(" frida-ls-devices")]),t._v(" "),a("blockquote",[a("p",[t._v("This is a command-line tool for killing processes.")])]),t._v(" "),a("p",[t._v("You can acquire PIDs from frida-ps tool.")]),t._v(" "),a("h3",{attrs:{id:"frida-kill"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frida-kill"}},[t._v("#")]),t._v(" frida-kill")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("frida-kill -D <DEVICE-ID> <PID>")])])]),t._v(" "),a("h3",{attrs:{id:"gum-graft"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gum-graft"}},[t._v("#")]),t._v(" gum-graft")]),t._v(" "),a("blockquote",[a("p",[t._v("The gum-graft tool is used for patching binaries ahead of time to allow Interceptor to instrument them in environments where runtime code modifications are prohibited. For now this only means Apple mobile OSes when strict code-signing policies are at play – i.e. on jailed systems when running an app without a debugger having been attached. In such cases, override the Gadget code_signing option and set it to required.\n"),a("a",{attrs:{href:"https://frida.re/docs/gum-graft/",target:"_blank",rel:"noopener noreferrer"}},[t._v("link"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"objection"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#objection"}},[t._v("#")]),t._v(" objection")]),t._v(" "),a("blockquote",[a("p",[a("RouterLink",{attrs:{to:"/pages/3a7fc5/"}},[t._v("jump")])],1)]),t._v(" "),a("h2",{attrs:{id:"最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),a("blockquote",[a("p",[t._v("This section is meant to contain best practices and pitfalls commonly encountered when using Frida. see: "),a("a",{attrs:{href:"https://frida.re/docs/best-practices/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://frida.re/docs/best-practices/"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("一、修改参数。绑定到调用对象上, 防止对象被 GC")]),t._v(" "),a("blockquote",[a("p",[t._v("This way you can read arguments in onEnter and access them later in onLeave.")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onEnter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" buf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Memory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUtf8String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mystring'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("buf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("二、函数调用后仍然使用的对象")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" myStringBuf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Memory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUtf8String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mystring'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nInterceptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("attach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onEnter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\targs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" myStringBuf\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("三、Reuse arguments")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Interceptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("attach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onEnter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readUtf8String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MZ'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hexdump")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("In the above example the first argument is obtained from the args array twice, and this is paying the cost of querying frida-gum for this information twice. To avoid wasting precious CPU cycles when needing the same argument multiple times, "),a("strong",[t._v("it is best to store this information using a local variable")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Interceptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("attach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onEnter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" firstArg "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("firstArg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readUtf8String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MZ'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hexdump")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("firstArg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("h2",{attrs:{id:"apm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apm"}},[t._v("#")]),t._v(" APM")]),t._v(" "),a("blockquote",[a("p",[t._v("使用 frida 分析 android 的卡顿技巧")])]),t._v(" "),a("p",[t._v("使用 Frida 来分析 Android 应用的卡顿问题是一种高效的技巧, 可以帮助你快速定位卡顿的原因。以下是一些使用 Frida 分析 Android 卡顿问题的技巧:")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Hook 主线程消息循环: 使用 Frida 在主线程消息循环中插入代码, 例如在 Looper.loop() 函数处进行 Hook。这样你可以跟踪主线程的消息处理, 并检测是否有耗时的任务导致卡顿。")])]),t._v(" "),a("li",[a("p",[t._v("Hook 动画相关方法: 如果应用中使用了动画, 可以尝试 Hook 与动画相关的方法, 例如 ViewPropertyAnimator 或 ObjectAnimator 相关的方法, 以检测动画的性能问题。")])]),t._v(" "),a("li",[a("p",[t._v("检测 IO 操作: Hook 文件读写和网络请求相关的方法, 以便检测是否有阻塞 IO 操作导致卡顿。")])]),t._v(" "),a("li",[a("p",[t._v("检测耗时计算: Hook 应用中的复杂计算或者大量数据处理的方法, 以便找出可能导致卡顿的耗时操作。")])]),t._v(" "),a("li",[a("p",[t._v("TraceCompat API: 在关键方法中插入 TraceCompat 的 beginSection 和 endSection, 可以使用 Perfetto 或者 Systrace 来分析应用的执行流程和耗时。")])]),t._v(" "),a("li",[a("p",[t._v("监听消息队列: 通过 Hook MessageQueue.enqueueMessage() 方法, 可以监视消息队列中的消息处理情况, 从而找出消息处理时间过长的情况。")])]),t._v(" "),a("li",[a("p",[t._v("监控线程状态: 使用 Frida 监控线程状态, 例如检测线程是否处于等待状态或者死锁状态。")])]),t._v(" "),a("li",[a("p",[t._v("统计方法耗时: 使用 Frida 统计方法的执行时间, 并记录下方法的调用栈, 从而找到耗时操作的位置。")])])]),t._v(" "),a("p",[t._v("请注意, 使用 Frida 进行分析需要一定的技术知识和经验, 建议在分析之前先熟悉 Frida 的基本用法和 Android 应用的工作原理。同时, 为了保证分析的准确性和可靠性, 建议在开发环境或者测试环境中进行分析, 而不是在生产环境中直接运行 Frida 脚本。")]),t._v(" "),a("h2",{attrs:{id:"其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),a("h3",{attrs:{id:"根据特征搜索类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#根据特征搜索类"}},[t._v("#")]),t._v(" 根据特征搜索类")]),t._v(" "),a("p",[t._v("一、背景")]),t._v(" "),a("blockquote",[a("p",[t._v("在生产环境获取 progurad 类名")])]),t._v(" "),a("h3",{attrs:{id:"破解方法论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#破解方法论"}},[t._v("#")]),t._v(" 破解方法论")]),t._v(" "),a("p",[t._v("Frida 是一个功能强大的动态分析工具, 可用于 Android 和 iOS 应用的逆向工程、漏洞分析、代码修改等方面。以下是使用 Frida 破解应用的一般思路:")]),t._v(" "),a("ul",[a("li",[t._v("目标分析:  首先, 你需要确定要破解的目标应用, 并分析它的功能、运行机制以及可能存在的漏洞。这可以包括查找敏感信息、关键函数、加密/解密逻辑等。")]),t._v(" "),a("li",[t._v("环境设置:  安装 Frida 并设置好开发环境。你需要 Frida 的命令行工具以及 Python 包, 以便在 Frida 脚本中使用 Python。")]),t._v(" "),a("li",[t._v("Hooking:  使用 Frida 脚本 Hook 应用中的函数。通过 Hooking, 你可以插入自己的代码到目标应用的运行流程中。这样你就可以观察、修改、替换函数的行为。")]),t._v(" "),a("li",[t._v("函数分析:  一旦成功 Hook 了目标函数, 你可以通过 Frida 提供的 API 监控函数的输入、输出参数, 甚至修改它们。这可以用于绕过验证、修改敏感数据等。")]),t._v(" "),a("li",[t._v("数据抓取:  使用 Frida 脚本获取应用中的敏感数据。例如, 你可以监控网络通信、文件读写操作, 获取加密密钥等。")]),t._v(" "),a("li",[t._v("漏洞挖掘:  Frida 可用于发现应用中的漏洞, 例如不正确的验证逻辑、代码注入漏洞等。你可以 Hook 目标函数并分析其行为, 寻找可能的漏洞。")]),t._v(" "),a("li",[t._v("反编译与修改:  通过 Hooking, 你可以获得应用内存中的代码, 然后可以反编译它。这允许你修改应用的代码、跳过验证、绕过限制等。")]),t._v(" "),a("li",[t._v("安全检测:  Frida 也可用于安全评估。你可以 Hook 安全敏感函数, 检测是否有未经授权的访问、数据泄露等。")])]),t._v(" "),a("p",[t._v("需要注意的是, Frida 用于破解应用涉及法律和伦理问题, 因此在使用 Frida 进行逆向工程之前, 请务必了解并遵守法律法规, 以及遵循合法的使用方式。不当的使用 Frida 可能会侵犯应用开发者的权益, 甚至可能触犯法律。")]),t._v(" "),a("h2",{attrs:{id:"破解思想"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#破解思想"}},[t._v("#")]),t._v(" 破解思想")]),t._v(" "),a("ul",[a("li",[t._v("使用 file monitor 监控文件的打开情况")]),t._v(" "),a("li",[t._v("hook 系统的方法, 找到应用混淆的代码。 frida 脚本，通过 "),a("code",[t._v("frida $HOOKER_DRIVER -l $1 <pageage> --no-pause")]),t._v(" 漫游内存内容")]),t._v(" "),a("li",[t._v("运行时调试apk,  实战可见"),a("RouterLink",{attrs:{to:"/pages/2aa5cb/"}},[t._v("smali调试抖音app")])],1),t._v(" "),a("li",[t._v("查看View: 通过magisk的全局debug， 使用 layout inspector (有AS 版本要求)。查看view的内容")])]),t._v(" "),a("h2",{attrs:{id:"使用-frida-抓包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-frida-抓包"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.anquanke.com/post/id/197657#h2-9",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 frida 抓包"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("服务器校验客户端证书: 如果使用 charles 抓包的话,  就需要将 app 中内置的证书导入到 Charles 中去。")]),t._v(" "),a("li",[t._v("SSL pinning: 客户端并不会默认信任系统根证书目录中的证书, 而是在代码里再加一层校验")])]),t._v(" "),a("h2",{attrs:{id:"link"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#link"}},[t._v("#")]),t._v(" link")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://frida.re/",target:"_blank",rel:"noopener noreferrer"}},[t._v("frida"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://frida.re/docs/javascript-api/",target:"_blank",rel:"noopener noreferrer"}},[t._v("javascript-api"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/jacky1234/hooker",target:"_blank",rel:"noopener noreferrer"}},[t._v("hooker"),a("OutboundLink")],1),t._v(" hooker 是一个基于 frida 实现的逆向工具包。为逆向开发人员提供统一化的脚本包管理方式、通杀脚本、自动化生成 hook 脚本、内存漫游探测 activity 和 service、frida 版 JustTrustMe。"),a("a",{attrs:{href:"https://github.com/CreditTone/hooker",target:"_blank",rel:"noopener noreferrer"}},[t._v("原链接"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/jacky1234/radar4hooker",target:"_blank",rel:"noopener noreferrer"}},[t._v("radar4hooker"),a("OutboundLink")],1),t._v(" 为 hooker 提供的 dex 增强功能库")])])])]),t._v(" "),a("RText",{attrs:{text:"资讯"}}),t._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://www.anquanke.com/post/id/197657",target:"_blank",rel:"noopener noreferrer"}},[t._v("实用 FRIDA 进阶: 内存漫游、hook anywhere、抓包-安全客"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.anquanke.com/post/id/197670",target:"_blank",rel:"noopener noreferrer"}},[t._v("实用 FRIDA 进阶: 脱壳、自动化、高频问题-安全客"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("原理")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://mabin004.github.io/2018/07/31/Mac%E4%B8%8A%E7%BC%96%E8%AF%91Frida/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Frida 源码分析"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/51e6aef175a2",target:"_blank",rel:"noopener noreferrer"}},[t._v("hook 工具 frida 原理及使用"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("p",[t._v("逆向社区")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/CreditTone?tab=stars",target:"_blank",rel:"noopener noreferrer"}},[t._v("CreditTone"),a("OutboundLink")],1),t._v(" 这个人一直在做逆向相关的工作")])])]),t._v(" "),a("li",[a("p",[a("RouterLink",{attrs:{to:"/pages/9670c2/"}},[t._v("frida 命令记录")])],1)])])],1)}),[],!1,null,null,null);a.default=e.exports}}]);