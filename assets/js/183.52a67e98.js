(window.webpackJsonp=window.webpackJsonp||[]).push([[183],{499:function(t,a,r){"use strict";r.r(a);var o=r(4),n=Object(o.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("因为业务原因, 我们发现竞品抖音 app 在 harmonyOS 4 上, 通过手势退到后台, 短视频的暂停速度非常快。 而一般的暂停播放方式是在 'Fragment#onPause'. 在手势上滑, 退出到当前应用到后台的场景下, 'Fragment#onPause' 会在动画结束后才会回调。 导致已经退到桌面很久了, 但是音频还没有暂停, 对用户的体验不是很好")])]),t._v(" "),a("p",[a("strong",[t._v("环境")])]),t._v(" "),a("ol",[a("li",[t._v("os: harmonyOS 4")]),t._v(" "),a("li",[t._v("抖音 version:  28.0+")])]),t._v(" "),a("h2",{attrs:{id:"调研"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调研"}},[t._v("#")]),t._v(" 调研")]),t._v(" "),a("p",[t._v("这里总结了调研的一些思路和步骤")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("harmony 4 开发文档, 了解新特性. "),a("a",{attrs:{href:"https://developer.harmonyos.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("网站"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("debug 抖音 app,  见"),a("RouterLink",{attrs:{to:"/pages/2aa5cb/"}},[t._v("链接")]),t._v("。\n在 android 13 系统下,抖音退后台暂停也是通过 "),a("code",[t._v("Fragment#onPause")]),t._v(" 如下图:")],1),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/jacky1234/picArchieve@master/uPic/20240221_163326_NspsUT.png",alt:""}})])]),t._v(" "),a("li",[a("p",[t._v("通过 apktool 反解成 smali:  "),a("code",[t._v("apktool d -r {apk}")]),t._v(", 然后搜索, 'harmony' 关键字。这里我先过滤了 'const-string' 指令")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("rg 'const-string' --glob '*.smali' > const_string.txt")])]),t._v(" "),a("li",[a("code",[t._v("rg 'harmony' const_string.txt")]),t._v(": 再次过滤")])])]),t._v(" "),a("li",[a("p",[t._v("frida, objection 查找内存加载模块, 可以看看是否有鸿蒙相关的功能等等")])]),t._v(" "),a("li",[a("p",[t._v("root 鸿蒙 4.0 系统, 对比抖音和拼多多播放器暂停调用堆栈")])])]),t._v(" "),a("h2",{attrs:{id:"结论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结论"}},[t._v("#")]),t._v(" 结论")]),t._v(" "),a("p",[t._v("这一篇的结论有些戏剧性: 其实抖音通过手势上滑退到后台, 也采取的 Fragment#onPause 中暂停。但是重点来了: 鸿蒙系统对视频类应用会提前调用 "),a("code",[t._v("onPause")]),t._v(",  让应用页面提前进入 pause, 提前响应视频音频暂停。 (这也是跟华为客服沟通了解到的)")]),t._v(" "),a("RText",{attrs:{text:"申请步骤:"}}),t._v(" "),a("ol",[a("li",[t._v("发送申请邮件过来, 说明下具体背景和情况, 华为内部去评估下看能否给配置\n邮件地址为:  "),a("code",[t._v("hwthirdparty@huawei.com、guolulu2@h-partners.com、wangdandan46@h-partners.com、wangpei13@h-partners.com、yanglvhua@h-partners.com")])]),t._v(" "),a("li",[t._v("作废，不能申请")])])],1)}),[],!1,null,null,null);a.default=n.exports}}]);