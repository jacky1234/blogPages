(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{543:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"setuptools-打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setuptools-打包"}},[s._v("#")]),s._v(" setuptools 打包")]),s._v(" "),t("p",[s._v("要打包 Python 脚本, 你可以使用 Python 的内置模块 "),t("code",[s._v("distutils")]),s._v(" 或第三方模块 "),t("code",[s._v("setuptools")]),s._v("。这些工具可用于创建可分发的 Python 软件包, 以便其他人可以轻松安装和使用你的脚本。")]),s._v(" "),t("p",[s._v("下面的例子也是基于 "),t("code",[s._v("setuptools")]),s._v(" 展开")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("setuptools")]),s._v(": Easily download, build, install, upgrade, and uninstall Python packages. 更多内容请参阅"),t("a",{attrs:{href:"https://pypi.org/project/setuptools/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1),s._v("。")])]),s._v(" "),t("h3",{attrs:{id:"打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打包"}},[s._v("#")]),s._v(" 打包")]),s._v(" "),t("p",[s._v("下面是使用 "),t("code",[s._v("setuptools")]),s._v(" 工具 创建 Python 脚本的示例:")]),s._v(" "),t("p",[s._v("1.确保你的项目目录结构如下所示:")]),s._v(" "),t("div",{staticClass:"language-lua line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-lua"}},[t("code",[s._v("my_script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- setup.py")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- my_script/")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- __init__.py")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- script.py")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("2.在项目根目录下创建 "),t("code",[s._v("setup.py")]),s._v(" 文件, 并添加以下内容:")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" setuptools "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" setup\n\nsetup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my_script'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.0'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    packages"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my_script'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    install_requires"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    entry_points"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'console_scripts'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'aaa = my_script.script:main'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("在 setup 函数中, 你需要指定包的名称、版本号、包含的模块等信息。")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("install_requires")]),s._v("参数用于指定项目的依赖项, 这些依赖项将在安装项目时自动安装")]),s._v(" "),t("li",[t("code",[s._v("entry_points")]),s._v(" 部分用于将你的脚本与可执行命令关联起来")])]),s._v(" "),t("p",[s._v("通过上面的配置打包后, 当你安装软件包并在终端中运行 "),t("code",[s._v("aaa")]),s._v(" 命令时, 将执行 my_script.script 模块中的 "),t("code",[s._v("main")]),s._v(" 函数。")]),s._v(" "),t("p",[s._v("3.在 my_script 目录下创建 "),t("code",[s._v("__init__.py")]),s._v(" 文件, 可以留空。")]),s._v(" "),t("p",[s._v("4.在 my_script 目录下创建你的 Python 脚本文件 "),t("code",[s._v("script.py")]),s._v(", 并添加你的脚本代码。例如:")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello, World!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" __name__ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'__main__'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("5.打开终端, 导航到项目根目录, 并运行以下命令来构建软件包:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("python setup.py sdist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这将在 dist 目录中生成一个压缩文件, 其中包含你的软件包。")]),s._v(" "),t("p",[s._v("6.如果你希望其他人能够使用 pip 命令安装你的软件包, 可以将软件包上传到 PyPI 或创建一个本地仓库。要上传到 PyPI, 请按照官方文档中的说明进行操作。如果要创建本地仓库, 可以使用工具如 devpi 或 twine。")]),s._v(" "),t("h3",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("p",[s._v("经过上面的流程后安装包位置在 "),t("code",[s._v("./dist/my_script-1.0.tar.gz")]),s._v(". 通过 "),t("code",[s._v("pip3")]),s._v(" 命令安装")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" dist/my_script-1.0.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制重新安装")]),s._v("\npip3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" dist/my_script-1.0.tar.gz --force-reinstall\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("之后应该就可以正常上使用上面的 "),t("code",[s._v("aaa")]),s._v(" 命令了")]),s._v(" "),t("h2",{attrs:{id:"概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" 概念")]),s._v(" "),t("h3",{attrs:{id:"init-py文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#init-py文件"}},[s._v("#")]),s._v(" "),t("code",[s._v("__init__.py")]),s._v("文件")]),s._v(" "),t("p",[s._v("在 Python 中, "),t("code",[s._v("__init__.py")]),s._v("是一个特殊的文件, 用于标识一个目录作为 Python 包。当一个目录中包含了"),t("code",[s._v("__init__.py")]),s._v("文件时, Python 会将该目录视为一个包, 并可以通过导入该包来访问其中的模块和资源。")]),s._v(" "),t("p",[s._v("以下是"),t("code",[s._v("__init__.py")]),s._v("文件的一些常见用途:")]),s._v(" "),t("ol",[t("li",[s._v("声明包级别的初始化代码: 你可以在"),t("code",[s._v("__init__.py")]),s._v("文件中编写一些需要在导入包时执行的初始化代码。这些代码可以包括变量初始化、设置环境、导入子模块等。")]),s._v(" "),t("li",[s._v("导入模块: 在"),t("code",[s._v("__init__.py")]),s._v("文件中, 你可以导入该包下的模块, 使得在导入包时可以直接访问这些模块。这样, 在导入包时, 你可以使用更方便的包级别导入方式, 而不需要逐个导入每个模块。")]),s._v(" "),t("li",[s._v("定义包的接口: "),t("code",[s._v("__init__.py")]),s._v("文件可以作为包的接口, 提供外部使用该包时的接口定义。你可以在该文件中选择性地导入并重新导出包内的模块、类、函数等, 从而控制外部对包的可见性。")])]),s._v(" "),t("p",[s._v("需要注意的是, "),t("code",[s._v("__init__.py")]),s._v("文件并非必需的。在 Python 3.3 及以上的版本中, 如果你的目录仅作为包的容器而不包含额外的初始化代码或接口定义, 可以省略"),t("code",[s._v("__init__.py")]),s._v("文件。在这种情况下, Python 仍会将目录视为包, 但它将是一个隐式的包。")]),s._v(" "),t("p",[s._v("总之, "),t("code",[s._v("__init__.py")]),s._v("文件是用于标识一个目录作为 Python 包的文件, 在其中可以编写初始化代码、导入模块以及定义包的接口。")])])}),[],!1,null,null,null);t.default=e.exports}}]);