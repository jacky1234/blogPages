(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{384:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("PHP-FPM(PHP FastCGI Process Manager)是一种专门为处理高并发环境下的 PHP 脚本而设计的工具。它是 PHP 的一个进程管理器，主要用于提高网站的性能和稳定性，特别是在高负载情况下。PHP-FPM 是运行在 FastCGI 模式下的 PHP 解释器的一个实现。")])]),s._v(" "),a("RText",{attrs:{text:"注:"}}),s._v("FastCGI 是一种常用于提高交互式应用程序(如 Web 服务器)性能的协议。它扩展和改进了早期的 CGI(Common Gateway Interface)标准，提供了一种更高效、更可扩展的方式来处理请求。\n"),a("p",[s._v("PHP-FPM 是一个非常强大的工具，专为高并发和高性能环境下的 PHP 应用而设计。通过合理配置和优化，可以显著提高 PHP 应用的响应速度和稳定性。")]),s._v(" "),a("h2",{attrs:{id:"php-fpm-的主要功能和特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-fpm-的主要功能和特点"}},[s._v("#")]),s._v(" PHP-FPM 的主要功能和特点")]),s._v(" "),a("ol",[a("li",[s._v("进程管理:")])]),s._v(" "),a("ul",[a("li",[s._v("PHP-FPM 管理多个 PHP 工作进程，允许 PHP 解释器以多进程模式运行，以提高并发处理能力。")])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("负载均衡:")])]),s._v(" "),a("ul",[a("li",[s._v("它可以通过配置进程池来平衡负载，确保请求能够均匀分布到不同的进程中，防止某个进程过载。")])]),s._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[s._v("动态子进程生成:")])]),s._v(" "),a("ul",[a("li",[s._v("PHP-FPM 能根据需要动态地启动和关闭 PHP 子进程，从而更好地利用服务器资源。")])]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[s._v("日志功能:")])]),s._v(" "),a("ul",[a("li",[s._v("它提供了详细的日志记录功能，帮助开发者和系统管理员监控和排查问题。")])]),s._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[s._v("慢请求管理:")])]),s._v(" "),a("ul",[a("li",[s._v("PHP-FPM 可以记录执行时间过长的请求，便于性能优化和故障排除。")])]),s._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[s._v("配置灵活:")])]),s._v(" "),a("ul",[a("li",[s._v("PHP-FPM 提供了灵活的配置选项，可以针对不同的应用场景进行优化配置。")])]),s._v(" "),a("h2",{attrs:{id:"安装和配置-php-fpm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装和配置-php-fpm"}},[s._v("#")]),s._v(" 安装和配置 PHP-FPM")]),s._v(" "),a("h3",{attrs:{id:"安装-php-fpm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-php-fpm"}},[s._v("#")]),s._v(" 安装 PHP-FPM")]),s._v(" "),a("p",[s._v("在大多数 Linux 发行版上，可以通过包管理器安装 PHP-FPM。例如，在 Ubuntu 上，可以使用以下命令安装 PHP-FPM:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" php-fpm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"配置-php-fpm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-php-fpm"}},[s._v("#")]),s._v(" 配置 PHP-FPM")]),s._v(" "),a("p",[s._v("PHP-FPM 的主要配置文件通常位于 "),a("code",[s._v("/etc/php/<version>/fpm/php-fpm.conf")]),s._v("。此外，每个进程池的配置文件位于 "),a("code",[s._v("/etc/php/<version>/fpm/pool.d/")]),s._v(" 目录下。")]),s._v(" "),a("p",[s._v("典型的 "),a("code",[s._v("php-fpm.conf")]),s._v(" 配置文件示例:")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token section"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("global")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pid")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/run/php/php-fpm.pid")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("error_log")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/log/php-fpm.log")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("include")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/etc/php/<version>/fpm/pool.d/*.conf")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("一个典型的进程池配置文件示例(如 "),a("code",[s._v("www.conf")]),s._v("):")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token section"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("www")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("user")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("www-data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("www-data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("listen")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/run/php/php-fpm.sock")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("listen.owner")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("www-data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("listen.group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("www-data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("listen.mode")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("0660")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("dynamic")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pm.max_children")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("50")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pm.start_servers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pm.min_spare_servers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pm.max_spare_servers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("35")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("slowlog")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/log/php-fpm/www-slow.log")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("request_slowlog_timeout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("5s")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"启动和管理-php-fpm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动和管理-php-fpm"}},[s._v("#")]),s._v(" 启动和管理 PHP-FPM")]),s._v(" "),a("p",[s._v("安装完成并配置好 PHP-FPM 后，可以通过以下命令启动和管理 PHP-FPM 服务:")]),s._v(" "),a("code-group",[a("code-block",{attrs:{title:"linux",active:""}},[a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start php-fpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" php-fpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl status php-fpm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("code-block",{attrs:{title:"mac"}},[a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("brew services start php\nbrew services stop php\nbrew services restart php\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])],1),s._v(" "),a("p",[s._v("在大多数现代 Linux 发行版上，使用 systemctl 命令可以方便地管理 PHP-FPM 服务。")]),s._v(" "),a("h3",{attrs:{id:"验证-php-fpm-是否在运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证-php-fpm-是否在运行"}},[s._v("#")]),s._v(" 验证 PHP-FPM 是否在运行")]),s._v(" "),a("p",[s._v("可以通过检查 PHP-FPM 的监听端口或套接字来确认其是否正在运行:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("lsof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Pni")]),s._v(" :9000\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或检查套接字文件:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-la")]),s._v(" /usr/local/var/run/php-fpm.sock\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如果看到 PHP-FPM 正在监听相应的端口或套接字文件存在且有适当的权限，则 PHP-FPM 运行正常。")])],1)}),[],!1,null,null,null);a.default=n.exports}}]);